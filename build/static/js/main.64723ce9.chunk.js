(this["webpackJsonpreact-tuner"]=this["webpackJsonpreact-tuner"]||[]).push([[0],{11:function(e,t,n){},14:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(5),i=n.n(s),c=(n(11),n(4)),o=n.n(c),l=n(6),u=n(2),d=new(window.AudioContext||window.webkitAudioContext),f=d.createAnalyser();f.fftSize=2048;var b={getAudioContext:function(){return d},getAnalyser:function(){return f},resetAnalyser:function(){f=d.createAnalyser()},decodeAudioData:function(e){d.decodeAudioData(e).then((function(e){}))}};var x=function(e,t){return Math.floor(1200*Math.log(e/function(e){return 440*Math.pow(2,(e-69)/12)}(t))/Math.log(2))},j=function(e){return e>0?50+e:50-e},h=n(0),m=b.getAudioContext(),v=b.getAnalyser(),g=new Float32Array(2048),O=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];var p=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(!1),i=Object(u.a)(s,2),c=i[0],d=i[1],f=Object(a.useState)("C"),b=Object(u.a)(f,2),p=b[0],w=b[1],y=Object(a.useState)("4"),A=Object(u.a)(y,2),M=A[0],N=A[1],S=Object(a.useState)("0 Hz"),C=Object(u.a)(S,2),k=C[0],D=C[1],F=Object(a.useState)("0"),z=Object(u.a)(F,2),E=z[0],G=z[1],I=Object(a.useState)(!1),B=Object(u.a)(I,2),H=B[0],J=B[1];Object(a.useEffect)((function(){null!=n&&n.connect(v)}),[n]),setInterval((function(e){v.getFloatTimeDomainData(g);var t=function(e,t){for(var n=e.length,a=0,r=0;r<n;r++){var s=e[r];a+=s*s}if((a=Math.sqrt(a/n))<.01)return-1;for(var i=0,c=n-1,o=0;o<n/2;o++)if(Math.abs(e[o])<.2){i=o;break}for(var l=1;l<n/2;l++)if(Math.abs(e[n-l])<.2){c=n-l;break}n=(e=e.slice(i,c)).length;for(var u=new Array(n).fill(0),d=0;d<n;d++)for(var f=0;f<n-d;f++)u[d]=u[d]+e[f]*e[f+d];for(var b=0;u[b]>u[b+1];)b++;for(var x=-1,j=-1,h=b;h<n;h++)u[h]>x&&(x=u[h],j=h);var m=j,v=u[m-1],g=u[m],O=u[m+1],p=(v+O-2*g)/2;return p&&(m-=(O-v)/2/(2*p)),t/m}(g,m.sampleRate);if(t>-1){var n=function(e){var t=Math.log(e/440)/Math.log(2)*12;return Math.round(t)+69}(t),a=O[n%12],r=Math.floor(n/12)-1,s=x(t,n);D(parseFloat(t).toFixed(2)+" Hz"),w(a),N(r),G(s),J(!1),console.log(n,a,r,s,t)}}),1);var T=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:if(t=e.sent,"suspended"!==m.state){e.next=6;break}return e.next=6,m.resume();case 6:d(!0),J(!0),setTimeout((function(){return J(!1)}),5e3),r(m.createMediaStreamSource(t));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q=function(){return navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,autoGainControl:!1,noiseSuppression:!1,latency:0}})};return Object(h.jsxs)("div",{className:"flex justify-center items-center h-screen",children:[Object(h.jsx)("div",{className:H?"visible transition-all fixed top-0 bg-gray-400 text-white w-10/12 text-xs md:text-sm text-center py-4 mt-2 rounded-full shadow-2xl":"invisible fixed top-0",children:"Please, bring your instrument near to the microphone!"}),Object(h.jsxs)("div",{className:"flex flex-col items-center",children:[Object(h.jsxs)("div",{className:c?"visible flex flex-col transition-all ease-in delay-75 bg-gray-200 justify-center items-center p-10 rounded-xl shadow-lg mb-5 w-60 h-60":"invisible transition-all w-0 h-0",children:[Object(h.jsxs)("div",{className:"flex items-start font-mono",children:[Object(h.jsx)("span",{className:c?"visible transition-all delay-75 font-thin text-9xl":"invisible text-xs",children:p}),Object(h.jsx)("span",{className:"bg-green-600 p-1 px-2 text-white rounded-lg",children:M})]}),Object(h.jsxs)("div",{className:"w-full flex justify-center items-center",children:[Object(h.jsx)("div",{className:"bg-gradient-to-r to-green-400 from-red-600 py-1 rounded-full rotate-180",style:{width:(E<0?j(E):"50")+"%"}}),Object(h.jsx)("span",{className:"fixed font-bold text-lg text-green-800",children:"I"}),Object(h.jsx)("div",{className:"bg-gradient-to-r from-green-400 to-red-600 py-1 rounded-full",style:{width:(E>0?j(E):"50")+"%"}})]}),Object(h.jsx)("div",{className:"mt-2 text-xs text-gray-400",children:Object(h.jsx)("span",{children:k})})]}),c?Object(h.jsx)("button",{className:"bg-red-800 text-white w-20 h-20 rounded-full shadow-xl transition-all",onClick:function(){n.disconnect(v),d(!1)},children:"Stop"}):Object(h.jsx)("button",{className:"bg-red-600 text-white w-20 h-20 rounded-full shadow-xl transition-all",onClick:T,children:"Start"})]})]})};i.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(p,{})}),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.64723ce9.chunk.js.map